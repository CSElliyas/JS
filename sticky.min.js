!function(x){x.fn.theiaStickySidebar=function(i){var t,o;function e(i,t){return!0===i.initialized||!(x("body").width()<i.minWidth)&&(o=t,(u=i).initialized=!0,x("head").append(x('<style>.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style>')),o.each(function(){var o,i={};i.sidebar=x(this),i.options=u||{},i.container=x(i.options.containerSelector),0==i.container.length&&(i.container=i.sidebar.parent()),i.sidebar.parents().css("-webkit-transform","none"),i.sidebar.css({position:"relative",overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),i.stickySidebar=i.sidebar.find(".theiaStickySidebar"),0==i.stickySidebar.length&&(o=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i,i.sidebar.find("script").filter(function(i,t){return 0===t.type.length||t.type.match(o)}).remove(),i.stickySidebar=x("<div>").addClass("theiaStickySidebar").append(i.sidebar.children()),i.sidebar.append(i.stickySidebar)),i.marginBottom=parseInt(i.sidebar.css("margin-bottom")),i.paddingTop=parseInt(i.sidebar.css("padding-top")),i.paddingBottom=parseInt(i.sidebar.css("padding-bottom"));var t,e,a=i.stickySidebar.offset().top,d=i.stickySidebar.outerHeight();function m(){i.fixedScrollTop=0,i.sidebar.css({"min-height":"1px"}),i.stickySidebar.css({position:"static",width:"",transform:"none"})}i.stickySidebar.css("padding-top",1),i.stickySidebar.css("padding-bottom",1),a-=i.stickySidebar.offset().top,d=i.stickySidebar.outerHeight()-d-a,0==a?(i.stickySidebar.css("padding-top",0),i.stickySidebarPaddingTop=0):i.stickySidebarPaddingTop=1,0==d?(i.stickySidebar.css("padding-bottom",0),i.stickySidebarPaddingBottom=0):i.stickySidebarPaddingBottom=1,i.previousScrollTop=null,i.fixedScrollTop=0,m(),i.onScroll=function(i){if(i.stickySidebar.is(":visible"))if(x("body").width()<i.options.minWidth)m();else{if(i.options.disableOnResponsiveLayouts)if(i.sidebar.outerWidth("none"==i.sidebar.css("float"))+50>i.container.width())return void m();var t,o,e,a,d,n,s,r,c,p,b,l,h,g,f,S=x(document).scrollTop(),y="static";S>=i.sidebar.offset().top+(i.paddingTop-i.options.additionalMarginTop)&&(t=i.paddingTop+u.additionalMarginTop,o=i.paddingBottom+i.marginBottom+u.additionalMarginBottom,e=i.sidebar.offset().top,a=i.sidebar.offset().top+(l=i.container,h=l.height(),l.children().each(function(){h=Math.max(h,x(this).height())}),h),d=0+u.additionalMarginTop,n=i.stickySidebar.outerHeight()+t+o<x(window).height()?d+i.stickySidebar.outerHeight():x(window).height()-i.marginBottom-i.paddingBottom-u.additionalMarginBottom,s=e-S+i.paddingTop,r=a-S-i.paddingBottom-i.marginBottom,c=i.stickySidebar.offset().top-S,p=i.previousScrollTop-S,"fixed"==i.stickySidebar.css("position")&&"modern"==i.options.sidebarBehavior&&(c+=p),"stick-to-top"==i.options.sidebarBehavior&&(c=u.additionalMarginTop),"stick-to-bottom"==i.options.sidebarBehavior&&(c=n-i.stickySidebar.outerHeight()),c=0<p?Math.min(c,d):Math.max(c,n-i.stickySidebar.outerHeight()),c=Math.max(c,s),c=Math.min(c,r-i.stickySidebar.outerHeight()),y=((b=i.container.height()==i.stickySidebar.outerHeight())||c!=d)&&(b||c!=n-i.stickySidebar.outerHeight())?S+c-i.sidebar.offset().top-i.paddingTop<=u.additionalMarginTop?"static":"absolute":"fixed"),"fixed"==y?(g=x(document).scrollLeft(),i.stickySidebar.css({position:"fixed",width:k(i.stickySidebar)+"px",transform:"translateY("+c+"px)",left:i.sidebar.offset().left+parseInt(i.sidebar.css("padding-left"))-g+"px",top:"0px"})):"absolute"==y?(f={},"absolute"!=i.stickySidebar.css("position")&&(f.position="absolute",f.transform="translateY("+(S+c-i.sidebar.offset().top-i.stickySidebarPaddingTop-i.stickySidebarPaddingBottom)+"px)",f.top="0px"),f.width=k(i.stickySidebar)+"px",f.left="",i.stickySidebar.css(f)):"static"==y&&m(),"static"!=y&&1==i.options.updateSidebarHeight&&i.sidebar.css({"min-height":i.stickySidebar.outerHeight()+i.stickySidebar.offset().top-i.sidebar.offset().top+i.paddingBottom}),i.previousScrollTop=S}},i.onScroll(i),x(document).scroll((t=i,function(){t.onScroll(t)})),x(window).resize((e=i,function(){e.stickySidebar.css({position:"static"}),e.onScroll(e)}))}),!0);var u,o}function k(i){var t;try{t=i[0].getBoundingClientRect().width}catch(i){}return void 0===t&&(t=i.width()),t}(i=x.extend({containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:!0,minWidth:0,disableOnResponsiveLayouts:!0,sidebarBehavior:"modern"},i)).additionalMarginTop=parseInt(i.additionalMarginTop)||0,i.additionalMarginBottom=parseInt(i.additionalMarginBottom)||0,e(t=i,o=this)||(console.log("TSS: Body width smaller than options.minWidth. Init is delayed."),x(document).scroll(function(t,o){return function(i){e(t,o)&&x(this).unbind(i)}}(t,o)),x(window).resize(function(t,o){return function(i){e(t,o)&&x(this).unbind(i)}}(t,o)))}}(jQuery);
